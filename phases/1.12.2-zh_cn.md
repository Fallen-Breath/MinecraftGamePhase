[English](1.12.2-en_us.md) | **中文**

# Minecraft 1.12.2 游戏阶段

适用版本: 1.12.x

## 游戏阶段树 (精简)

```
游戏循环
├── 玩家动作
├── 对于每一个维度
│   ├── 自然刷怪
│   ├── 区块卸载
│   ├── 更新世界时间
│   ├── 计划刻
│   ├── 区块刻
│   ├── 方块变化同步
│   ├── 方块事件
│   ├── 实体
│   └── 方块实体
├── 玩家实体
└── 自动保存
```

## 游戏阶段树 (完整)

```
游戏循环
├── 异步事件
│   └── 玩家动作
├── 对于每一个维度
│   ├── 同步世界时间
│   ├── 天气
│   ├── 睡觉
│   ├── 自然刷怪
│   ├── 区块卸载
│   ├── 更新世界时间
│   ├── 计划刻
│   ├── 随机亮度更新
│   ├── 区块刻
│   │   ├── 光照逻辑
│   │   ├── 雷电
│   │   ├── 冰雪
│   │   └── 随机刻
│   ├── 玩家加载区块图
│   │   └── 方块变化同步
│   ├── 村庄
│   ├── 僵尸攻城生成
│   ├── 地狱门缓存
│   ├── 方块事件
│   ├── 龙战
│   ├── 实体
│   ├── 方块实体
│   └── 实体追踪器
├── 网络
│   └── 玩家实体
├── 函数及数据包
├── 控制台
└── 自动保存
```

## 游戏阶段详情

### 游戏循环

无限执行的主循环

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.MinecraftServer#runServer`

### 异步事件

执行异步计划的事件

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.MinecraftServer#waitUntilNextTick`
- 主调函数: `net.minecraft.server.MinecraftServer#runServer`

### 玩家动作

处理来自客户端数据包的玩家动作

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.network.protocol.PacketUtils#ensureRunningOnSameThread`

### 对于每一个维度

对于每一个维度，执行其下逻辑

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.MinecraftServer#tickChildren`

### 同步世界时间

向客户端同步世界时间

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.network.protocol.game.ClientboundSetTimePacket`
- 主调函数: `net.minecraft.server.MinecraftServer#tickChildren`

### 天气

天气逻辑更新

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.level.ServerLevel#advanceWeatherCycle`
- 主调函数: `net.minecraft.server.level.ServerLevel#tick`

### 睡觉

玩家睡觉逻辑

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.level.ServerLevel#wakeUpAllPlayers`
- 主调函数: `net.minecraft.server.level.ServerLevel#tick`

### 自然刷怪

怪物自然生成

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.world.level.NaturalSpawner#spawnForChunk`
- 主调函数: `net.minecraft.server.level.ServerChunkCache#tickChunks`

### 区块卸载

卸载区块

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.level.ChunkMap#tick(java.util.function.BooleanSupplier)`
- 主调函数: `net.minecraft.server.level.ServerChunkCache#tick`

### 更新世界时间

更新世界的 gametime 以及 daytime

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.level.ServerLevel#tickTime`
- 主调函数: `net.minecraft.server.level.ServerLevel#tick`

### 计划刻

执行计划刻事件，包括方块计划刻以及流体计划刻

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.world.ticks.LevelTicks#tick`
- 主调函数: `net.minecraft.server.level.ServerLevel#tick`

### 随机亮度更新

发生在玩家附近的随机亮度更新

**代码参考**

Minecraft 1.13.2, mcp 反混淆表

- 代码位置: `net.minecraft.world.WorldServer#playerCheckLight`
- 主调函数: `net.minecraft.world.WorldServer#tickBlocks`

### 区块刻

区块刻

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.level.ServerLevel#tickChunk`
- 主调函数: `net.minecraft.server.level.ServerChunkCache#tickChunks`

### 光照逻辑

亮度检查以及天空光重计算

**代码参考**

Minecraft 1.13.2, mcp 反混淆表

- 代码位置: `net.minecraft.world.chunk.Chunk#enqueueRelightChecks`
- 主调函数: `net.minecraft.world.WorldServer#tickBlocks`

### 雷电

生成雷电以及骷髅马陷阱

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.level.ServerLevel#tickChunk`

### 冰雪

结冰、积雪

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.level.ServerLevel#tickChunk`

### 随机刻

方块以及流体随机刻

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.level.ServerLevel#tickChunk`

### 玩家加载区块图

玩家加载区块图更新

**代码参考**

Minecraft 1.13.2, mcp 反混淆表

- 代码位置: `net.minecraft.server.management.PlayerChunkMap#tick`
- 主调函数: `net.minecraft.world.WorldServer#tick`

### 方块变化同步

向客户端同步区块中的方块变化

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.level.ChunkHolder#broadcastChanges`
- 主调函数: `net.minecraft.server.level.ServerChunkCache#tickChunks`

### 村庄

村庄相关逻辑

**代码参考**

Minecraft 1.13.2, mcp 反混淆表

- 代码位置: `net.minecraft.village.VillageCollection#tick`
- 主调函数: `net.minecraft.world.WorldServer#tick`

### 僵尸攻城生成

生成僵尸攻城

**代码参考**

Minecraft 1.13.2, mcp 反混淆表

- 代码位置: `net.minecraft.village.VillageSiege#tick`
- 主调函数: `net.minecraft.world.WorldServer#tick`

### 地狱门缓存

清理超时的地狱门缓存

**代码参考**

Minecraft 1.13.2, mcp 反混淆表

- 代码位置: `net.minecraft.world.Teleporter#tick`
- 主调函数: `net.minecraft.world.WorldServer#tick`

### 方块事件

执行方块事件

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.level.ServerLevel#runBlockEvents`
- 主调函数: `net.minecraft.server.level.ServerLevel#tick`

### 龙战

龙战逻辑

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.world.level.dimension.end.EndDragonFight#tick`
- 主调函数: `net.minecraft.server.level.ServerLevel#tick`

### 实体

运算实体

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.world.level.Level#guardEntityTick`
- 主调函数: `net.minecraft.server.level.ServerLevel#tick`

### 方块实体

运算方块实体

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.world.level.Level#tickBlockEntities`
- 主调函数: `net.minecraft.server.level.ServerLevel#tick`

### 实体追踪器

向客户端同步实体状态更新

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.level.ChunkMap#tick`
- 主调函数: `net.minecraft.server.level.ServerChunkCache#tickChunks`

### 网络

网络连接运算

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.network.ServerConnectionListener#tick`
- 主调函数: `net.minecraft.server.MinecraftServer#tickChildren`

### 玩家实体

运算玩家的实体相关逻辑

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.network.ServerGamePacketListenerImpl#tick`
- 主调函数: `net.minecraft.network.Connection#tick`

### 函数及数据包

函数与数据包的指令

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.ServerFunctionManager#tick`
- 主调函数: `net.minecraft.server.MinecraftServer#tickChildren`

### 控制台

处理控制台输入的指令

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.dedicated.DedicatedServer#handleConsoleInputs`
- 主调函数: `net.minecraft.server.dedicated.DedicatedServer#tickChildren`

### 自动保存

自动保存

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.MinecraftServer#saveEverything`
- 主调函数: `net.minecraft.server.MinecraftServer#tickServer`

