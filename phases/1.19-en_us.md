**English** | [中文](1.19-zh_cn.md)

# Game phase for Minecraft 1.19

Applicable versions: 1.19.x ~

## Phase Tree (Simplified)

```
Game Loop
├── For each world
│   ├── World Time Update
│   ├── Tile Tick
│   ├── For each chunk
│   │   ├── Natural Spawning
│   │   └── Chunk Tick
│   ├── Block Change Sync
│   ├── Chunk Unload
│   ├── Block Event
│   ├── Entity
│   └── Tile Entity
├── Player Entity
├── Auto save
└── Player Action
```

## Phase Tree (Full)

```
Game Loop
├── Command Function
├── For each world
│   ├── World Time Sync
│   ├── World Border
│   ├── Weather
│   ├── Sleeping
│   ├── World Time Update
│   ├── Tile Tick
│   ├── Raid
│   ├── Ticket
│   ├── For each chunk
│   │   ├── Natural Spawning
│   │   └── Chunk Tick
│   │       ├── Thunder
│   │       ├── Ice and Snow
│   │       └── Random Tick
│   ├── Special Spawning
│   │   ├── Phantom Spawning
│   │   ├── Patrol Spawning
│   │   ├── Cat Spawning
│   │   ├── Zombie Siege Spawning
│   │   └── Wandering Trader Spawning
│   ├── Block Change Sync
│   ├── Entity Tracker
│   ├── Chunk Unload
│   ├── Block Event
│   ├── Dragon Fight
│   ├── Entity
│   ├── Tile Entity
│   ├── Entity Management
│   └── Game Event
├── Network
│   └── Player Entity
├── Console
├── Auto save
└── Async task
    └── Player Action
```

## Phase Details

### Game Loop

The main and the infinite loop

**Code References**

Minecraft 1.19, mojmap mapping

- Reference: `net.minecraft.server.MinecraftServer#runServer`

### Command Function

Executes functions and datapacks

**Code References**

Minecraft 1.19, mojmap mapping

- Reference: `net.minecraft.server.ServerFunctionManager#tick`
- Caller: `net.minecraft.server.MinecraftServer#tickChildren`

### For each world

For each world, do following logics

**Code References**

Minecraft 1.19, mojmap mapping

- Reference: `net.minecraft.server.MinecraftServer#tickChildren`

### World Time Sync

Sync world time to client

**Code References**

Minecraft 1.19, mojmap mapping

- Reference: `net.minecraft.network.protocol.game.ClientboundSetTimePacket`
- Caller: `net.minecraft.server.MinecraftServer#tickChildren`

### World Border

World border update

**Code References**

Minecraft 1.19, mojmap mapping

- Reference: `net.minecraft.world.level.border.WorldBorder#tick`
- Caller: `net.minecraft.server.level.ServerLevel#tick`

### Weather

Update weather

**Code References**

Minecraft 1.19, mojmap mapping

- Reference: `net.minecraft.server.level.ServerLevel#advanceWeatherCycle`
- Caller: `net.minecraft.server.level.ServerLevel#tick`

### Sleeping

Player sleeping logic

**Code References**

Minecraft 1.19, mojmap mapping

- Reference: `net.minecraft.server.level.ServerLevel#wakeUpAllPlayers`
- Caller: `net.minecraft.server.level.ServerLevel#tick`

### World Time Update

Update gametime and daytime of the world

**Code References**

Minecraft 1.19, mojmap mapping

- Reference: `net.minecraft.server.level.ServerLevel#tickTime`
- Caller: `net.minecraft.server.level.ServerLevel#tick`

### Tile Tick

Executing tile tick events, including block tile ticks and fluid tile ticks

**Code References**

Minecraft 1.19, mojmap mapping

- Reference: `net.minecraft.world.ticks.LevelTicks#tick`
- Caller: `net.minecraft.server.level.ServerLevel#tick`

### Raid

Raid logics

**Code References**

Minecraft 1.19, mojmap mapping

- Reference: `net.minecraft.world.entity.raid.Raids#tick`
- Caller: `net.minecraft.server.level.ServerLevel#tick`

### Ticket

Ticket System update

**Code References**

Minecraft 1.19, mojmap mapping

- Reference: `net.minecraft.server.level.DistanceManager#purgeStaleTickets`
- Caller: `net.minecraft.server.level.ServerChunkCache#tick`

### For each chunk

For each chunk has player nearby, do following logics

**Code References**

Minecraft 1.19, mojmap mapping

- Reference: `net.minecraft.server.level.ServerChunkCache#tickChunks`

### Natural Spawning

Natural mob spawning

**Code References**

Minecraft 1.19, mojmap mapping

- Reference: `net.minecraft.world.level.NaturalSpawner#spawnForChunk`
- Caller: `net.minecraft.server.level.ServerChunkCache#tickChunks`

### Chunk Tick

Chunk Tick

**Code References**

Minecraft 1.19, mojmap mapping

- Reference: `net.minecraft.server.level.ServerLevel#tickChunk`
- Caller: `net.minecraft.server.level.ServerChunkCache#tickChunks`

### Thunder

Lighting and skeleton trap spawning

**Code References**

Minecraft 1.19, mojmap mapping

- Reference: `net.minecraft.server.level.ServerLevel#tickChunk`

### Ice and Snow

Forming ice and snow

**Code References**

Minecraft 1.19, mojmap mapping

- Reference: `net.minecraft.server.level.ServerLevel#tickChunk`

### Random Tick

Block and fluid random ticks

**Code References**

Minecraft 1.19, mojmap mapping

- Reference: `net.minecraft.server.level.ServerLevel#tickChunk`

### Special Spawning

Spawning special mobs

**Code References**

Minecraft 1.19, mojmap mapping

- Reference: `net.minecraft.server.level.ServerLevel#tickCustomSpawners`
- Caller: `net.minecraft.server.level.ServerChunkCache#tickChunks`

### Phantom Spawning

Spawning phantoms

**Code References**

Minecraft 1.19, mojmap mapping

- Reference: `net.minecraft.server.level.ServerLevel#tickCustomSpawners`
- Caller: `net.minecraft.server.level.ServerChunkCache#tickChunks`

### Patrol Spawning

Spawning pillager patrols

**Code References**

Minecraft 1.19, mojmap mapping

- Reference: `net.minecraft.server.level.ServerLevel#tickCustomSpawners`
- Caller: `net.minecraft.server.level.ServerChunkCache#tickChunks`

### Cat Spawning

Spawning cats in villages

**Code References**

Minecraft 1.19, mojmap mapping

- Reference: `net.minecraft.server.level.ServerLevel#tickCustomSpawners`
- Caller: `net.minecraft.server.level.ServerChunkCache#tickChunks`

### Zombie Siege Spawning

Spawning zombie sieges

**Code References**

Minecraft 1.19, mojmap mapping

- Reference: `net.minecraft.server.level.ServerLevel#tickCustomSpawners`
- Caller: `net.minecraft.server.level.ServerChunkCache#tickChunks`

### Wandering Trader Spawning

Spawning wandering traders

**Code References**

Minecraft 1.19, mojmap mapping

- Reference: `net.minecraft.server.level.ServerLevel#tickCustomSpawners`
- Caller: `net.minecraft.server.level.ServerChunkCache#tickChunks`

### Block Change Sync

Sync changed blocks in the chunk to the client

**Code References**

Minecraft 1.19, mojmap mapping

- Reference: `net.minecraft.server.level.ChunkHolder#broadcastChanges`
- Caller: `net.minecraft.server.level.ServerChunkCache#tickChunks`

### Entity Tracker

Sync entity updates to the client

**Code References**

Minecraft 1.19, mojmap mapping

- Reference: `net.minecraft.server.level.ChunkMap#tick`
- Caller: `net.minecraft.server.level.ServerChunkCache#tickChunks`

### Chunk Unload

Unloading chunks

**Code References**

Minecraft 1.19, mojmap mapping

- Reference: `net.minecraft.server.level.ChunkMap#tick(java.util.function.BooleanSupplier)`
- Caller: `net.minecraft.server.level.ServerChunkCache#tick`

### Block Event

Block events

**Code References**

Minecraft 1.19, mojmap mapping

- Reference: `net.minecraft.server.level.ServerLevel#runBlockEvents`
- Caller: `net.minecraft.server.level.ServerLevel#tick`

### Dragon Fight

Dragon fight logic

**Code References**

Minecraft 1.19, mojmap mapping

- Reference: `net.minecraft.world.level.dimension.end.EndDragonFight#tick`
- Caller: `net.minecraft.server.level.ServerLevel#tick`

### Entity

Ticking entities

**Code References**

Minecraft 1.19, mojmap mapping

- Reference: `net.minecraft.world.level.Level#guardEntityTick`
- Caller: `net.minecraft.server.level.ServerLevel#tick`

### Tile Entity

Ticking tile entities

**Code References**

Minecraft 1.19, mojmap mapping

- Reference: `net.minecraft.world.level.Level#tickBlockEntities`
- Caller: `net.minecraft.server.level.ServerLevel#tick`

### Entity Management

Load / Unload entities due to chunk load / unload

**Code References**

Minecraft 1.19, mojmap mapping

- Reference: `net.minecraft.world.level.entity.PersistentEntitySectionManager#tick`
- Caller: `net.minecraft.server.level.ServerLevel#tick`

### Game Event

Emit enqueued game events

**Code References**

Minecraft 1.19, mojmap mapping

- Reference: `net.minecraft.server.level.ServerLevel#sendGameEvents`
- Caller: `net.minecraft.server.level.ServerLevel#tick`

### Network

Network system ticking

**Code References**

Minecraft 1.19, mojmap mapping

- Reference: `net.minecraft.server.network.ServerConnectionListener#tick`
- Caller: `net.minecraft.server.MinecraftServer#tickChildren`

### Player Entity

Ticking entity logic of players

**Code References**

Minecraft 1.19, mojmap mapping

- Reference: `net.minecraft.server.network.ServerGamePacketListenerImpl#tick`
- Caller: `net.minecraft.network.Connection#tick`

### Console

Handling console inputs

**Code References**

Minecraft 1.19, mojmap mapping

- Reference: `net.minecraft.server.dedicated.DedicatedServer#handleConsoleInputs`
- Caller: `net.minecraft.server.dedicated.DedicatedServer#tickChildren`

### Auto save

Auto save

**Code References**

Minecraft 1.19, mojmap mapping

- Reference: `net.minecraft.server.MinecraftServer#saveEverything`
- Caller: `net.minecraft.server.MinecraftServer#tickServer`

### Async task

Executing async tasks

**Code References**

Minecraft 1.19, mojmap mapping

- Reference: `net.minecraft.server.MinecraftServer#waitUntilNextTick`
- Caller: `net.minecraft.server.MinecraftServer#runServer`

### Player Action

Handling player actions from packets from clients

**Code References**

Minecraft 1.19, mojmap mapping

- Reference: `net.minecraft.network.protocol.PacketUtils#ensureRunningOnSameThread`

