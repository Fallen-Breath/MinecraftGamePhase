[English](1.14.4-en_us.md) | **中文**

# Minecraft 1.14.4 游戏阶段

适用版本: 1.14.x ~ 1.15.x

## 游戏阶段树 (精简)

```
游戏循环
├── 对于每一个维度
│   ├── 更新世界时间
│   ├── 对于每一个区块
│   │   ├── 方块变化同步
│   │   ├── 自然刷怪
│   │   └── 区块刻
│   ├── 区块卸载
│   ├── 计划刻
│   ├── 方块事件
│   ├── 实体
│   └── 方块实体
├── 玩家实体
├── 自动保存
└── 玩家动作
```

## 游戏阶段树 (完整)

```
游戏循环
├── 函数及数据包
├── 对于每一个维度
│   ├── 同步世界时间
│   ├── 世界边界
│   ├── 天气
│   ├── 睡觉
│   ├── 更新世界时间
│   ├── 加载票
│   ├── 对于每一个区块
│   │   ├── 方块变化同步
│   │   ├── 自然刷怪
│   │   └── 区块刻
│   │       ├── 雷电
│   │       ├── 冰雪
│   │       └── 随机刻
│   ├── 特殊生成
│   │   ├── 幻翼生成
│   │   ├── 灾厄巡逻队生成
│   │   ├── 猫生成
│   │   └── 僵尸攻城生成
│   ├── 实体追踪器
│   ├── 区块卸载
│   ├── 计划刻
│   ├── 袭击
│   ├── 游商生成
│   ├── 方块事件
│   ├── 龙战
│   ├── 实体
│   └── 方块实体
├── 网络
│   └── 玩家实体
├── 控制台
├── 自动保存
└── 异步事件
    └── 玩家动作
```

## 游戏阶段详情

### 游戏循环

无限执行的主循环

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.MinecraftServer#runServer`

### 函数及数据包

函数与数据包的指令

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.ServerFunctionManager#tick`
- 主调函数 `net.minecraft.server.MinecraftServer#tickChildren`

### 对于每一个维度

对于每一个维度，执行其下逻辑

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.MinecraftServer#tickChildren`

### 同步世界时间

向客户端同步世界时间

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.network.protocol.game.ClientboundSetTimePacket`
- 主调函数 `net.minecraft.server.MinecraftServer#tickChildren`

### 世界边界

更新世界边界

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.world.level.border.WorldBorder#tick`
- 主调函数 `net.minecraft.server.level.ServerLevel#tick`

### 天气

天气逻辑更新

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.level.ServerLevel#advanceWeatherCycle`
- 主调函数 `net.minecraft.server.level.ServerLevel#tick`

### 睡觉

玩家睡觉逻辑

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.level.ServerLevel#wakeUpAllPlayers`
- 主调函数 `net.minecraft.server.level.ServerLevel#tick`

### 更新世界时间

更新世界的 gametime 以及 daytime

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.level.ServerLevel#tickTime`
- 主调函数 `net.minecraft.server.level.ServerLevel#tick`

### 加载票

加载票系统更新

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.level.DistanceManager#purgeStaleTickets`
- 主调函数 `net.minecraft.server.level.ServerChunkCache#tick`

### 对于每一个区块

对于每个附近有玩家的情况，执行其下逻辑

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.level.ServerChunkCache#tickChunks`

### 方块变化同步

向客户端同步区块中的方块变化

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.level.ChunkHolder#broadcastChanges`
- 主调函数 `net.minecraft.server.level.ServerChunkCache#tickChunks`

### 自然刷怪

怪物自然生成

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.world.level.NaturalSpawner#spawnForChunk`
- 主调函数 `net.minecraft.server.level.ServerChunkCache#tickChunks`

### 区块刻

区块刻

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.level.ServerLevel#tickChunk`
- 主调函数 `net.minecraft.server.level.ServerChunkCache#tickChunks`

### 雷电

生成雷电以及骷髅马陷阱

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.level.ServerLevel#tickChunk`

### 冰雪

结冰、积雪

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.level.ServerLevel#tickChunk`

### 随机刻

方块以及流体随机刻

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.level.ServerLevel#tickChunk`

### 特殊生成

特殊的生物生成逻辑

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.level.ServerLevel#tickCustomSpawners`
- 主调函数 `net.minecraft.server.level.ServerChunkCache#tickChunks`

### 幻翼生成

生成幻翼

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.level.ServerLevel#tickCustomSpawners`
- 主调函数 `net.minecraft.server.level.ServerChunkCache#tickChunks`

### 灾厄巡逻队生成

随机生成灾厄巡逻队

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.level.ServerLevel#tickCustomSpawners`
- 主调函数 `net.minecraft.server.level.ServerChunkCache#tickChunks`

### 猫生成

在村庄中生成猫

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.level.ServerLevel#tickCustomSpawners`
- 主调函数 `net.minecraft.server.level.ServerChunkCache#tickChunks`

### 僵尸攻城生成

生成僵尸攻城

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.level.ServerLevel#tickCustomSpawners`
- 主调函数 `net.minecraft.server.level.ServerChunkCache#tickChunks`

### 实体追踪器

向客户端同步实体状态更新

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.level.ChunkMap#tick`
- 主调函数 `net.minecraft.server.level.ServerChunkCache#tickChunks`

### 区块卸载

卸载区块

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.level.ChunkMap#tick(java.util.function.BooleanSupplier)`
- 主调函数 `net.minecraft.server.level.ServerChunkCache#tick`

### 计划刻

执行计划刻事件，包括方块计划刻以及流体计划刻

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.world.ticks.LevelTicks#tick`
- 主调函数 `net.minecraft.server.level.ServerLevel#tick`

### 袭击

袭击逻辑

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.world.entity.raid.Raids#tick`
- 主调函数 `net.minecraft.server.level.ServerLevel#tick`

### 游商生成

生成游商

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.level.ServerLevel#tickCustomSpawners`
- 主调函数 `net.minecraft.server.level.ServerChunkCache#tickChunks`

### 方块事件

执行方块事件

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.level.ServerLevel#runBlockEvents`
- 主调函数 `net.minecraft.server.level.ServerLevel#tick`

### 龙战

龙战逻辑

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.world.level.dimension.end.EndDragonFight#tick`
- 主调函数 `net.minecraft.server.level.ServerLevel#tick`

### 实体

运算实体

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.world.level.Level#guardEntityTick`
- 主调函数 `net.minecraft.server.level.ServerLevel#tick`

### 方块实体

运算方块实体

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.world.level.Level#tickBlockEntities`
- 主调函数 `net.minecraft.server.level.ServerLevel#tick`

### 网络

网络连接运算

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.network.ServerConnectionListener#tick`
- 主调函数 `net.minecraft.server.MinecraftServer#tickChildren`

### 玩家实体

运算玩家的实体相关逻辑

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.network.ServerGamePacketListenerImpl#tick`
- 主调函数 `net.minecraft.network.Connection#tick`

### 控制台

处理控制台输入的指令

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.dedicated.DedicatedServer#handleConsoleInputs`
- 主调函数 `net.minecraft.server.dedicated.DedicatedServer#tickChildren`

### 自动保存

自动保存

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.MinecraftServer#saveEverything`
- 主调函数 `net.minecraft.server.MinecraftServer#tickServer`

### 异步事件

执行异步计划的事件

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.server.MinecraftServer#waitUntilNextTick`
- 主调函数 `net.minecraft.server.MinecraftServer#runServer`

### 玩家动作

处理来自客户端数据包的玩家动作

**代码参考**

Minecraft 1.19, mojmap 反混淆表

- 代码位置: `net.minecraft.network.protocol.PacketUtils#ensureRunningOnSameThread`

